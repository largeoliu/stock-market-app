<!--pages/search/search.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-header">
    <view class="search-input-wrapper">
      <text class="search-icon">ğŸ”</text>
      <input 
        class="search-input"
        placeholder="æœç´¢è‚¡ç¥¨ä»£ç æˆ–åç§°"
        value="{{keyword}}"
        bindinput="onInputChange"
        focus="{{true}}"
        confirm-type="search"
      />
      <text 
        wx:if="{{keyword}}"
        class="clear-icon"
        bindtap="onClearInput"
      >âœ•</text>
    </view>
    <text class="cancel-btn" bindtap="onCancel">å–æ¶ˆ</text>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:if="{{showResults}}" class="search-results">
    <!-- åŠ è½½ä¸­ -->
    <view wx:if="{{loading}}" class="loading">
      <loading></loading>
      <text class="loading-text">æœç´¢ä¸­...</text>
    </view>
    
    <!-- æœç´¢ç»“æœåˆ—è¡¨ -->
    <view wx:elif="{{searchResults.length > 0}}" class="results-list">
      <view 
        wx:for="{{searchResults}}" 
        wx:key="symbol"
        class="result-item"
        data-stock="{{item}}"
        bindtap="onResultTap"
      >
        <view class="stock-info">
          <view class="stock-name">{{item.name}}</view>
          <view class="stock-code">{{item.symbol}} Â· {{item.market}}</view>
        </view>
        <view wx:if="{{item.price}}" class="stock-price">
          <view class="price">Â¥{{item.price}}</view>
          <view class="price-change {{item.change >= 0 ? 'text-success' : 'text-danger'}}">
            {{item.change >= 0 ? '+' : ''}}{{item.change}} ({{item.change >= 0 ? '+' : ''}}{{item.changePercent}}%)
          </view>
        </view>
      </view>
    </view>
    
    <!-- æ— ç»“æœ -->
    <view wx:else class="empty-results">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³è‚¡ç¥¨</text>
      <text class="empty-tip">è¯·å°è¯•ä½¿ç”¨è‚¡ç¥¨ä»£ç æˆ–å®Œæ•´åç§°æœç´¢</text>
    </view>
  </view>

  <!-- é»˜è®¤å†…å®¹ -->
  <view wx:else class="default-content">
    <!-- çƒ­é—¨è‚¡ç¥¨ -->
    <view class="section">
      <view class="section-title">çƒ­é—¨è‚¡ç¥¨</view>
      <view class="hot-stocks">
        <view 
          wx:for="{{hotStocks}}" 
          wx:key="symbol"
          class="hot-stock-tag"
          data-stock="{{item}}"
          bindtap="onHotStockTap"
        >
          {{item.name}}
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘æœç´¢ -->
    <view wx:if="{{recentSearches.length > 0}}" class="section">
      <view class="section-header">
        <text class="section-title">æœ€è¿‘æœç´¢</text>
        <text class="clear-all-btn" bindtap="clearAllRecentSearches">æ¸…ç©º</text>
      </view>
      <view class="recent-searches">
        <view 
          wx:for="{{recentSearches}}" 
          wx:key="symbol"
          class="recent-item"
          data-stock="{{item}}"
          bindtap="onRecentTap"
        >
          <view class="recent-info">
            <view class="recent-name">{{item.name}}</view>
            <view class="recent-code">{{item.symbol}}</view>
          </view>
          <text 
            class="delete-icon"
            data-index="{{index}}"
            bindtap="deleteRecentItem"
          >âœ•</text>
        </view>
      </view>
    </view>

    <!-- æœç´¢æç¤º -->
    <view class="section">
      <view class="search-tips card">
        <view class="tips-title">æœç´¢æç¤º</view>
        <view class="tips-content">
          <text class="tip-item">â€¢ æ”¯æŒè‚¡ç¥¨ä»£ç æœç´¢ï¼Œå¦‚ï¼š000001ã€600519ã€002389</text>
          <text class="tip-item">â€¢ æ”¯æŒè‚¡ç¥¨åç§°æœç´¢ï¼Œå¦‚ï¼šå¹³å®‰é“¶è¡Œã€è´µå·èŒ…å°</text>
          <text class="tip-item">â€¢ ä»…æ”¯æŒAè‚¡å¸‚åœºæŸ¥è¯¢</text>
        </view>
      </view>
    </view>
  </view>
</view>